-- H2 2.3.232; 
SET DB_CLOSE_DELAY -1;         
;              
CREATE USER IF NOT EXISTS "" SALT '' HASH '' ADMIN;            
CREATE SCHEMA IF NOT EXISTS "RDBTEST" AUTHORIZATION "";        
CREATE SEQUENCE "PUBLIC"."CHILD_SEQ" START WITH 1 RESTART WITH 51 INCREMENT BY 50;             
CREATE SEQUENCE "PUBLIC"."LCHILD_SEQ" START WITH 1 RESTART WITH 101 INCREMENT BY 50;           
CREATE SEQUENCE "PUBLIC"."PARENT_SEQ" START WITH 1 RESTART WITH 51 INCREMENT BY 50;            
CREATE SEQUENCE "PUBLIC"."REFERREDTO1_SEQ" START WITH 1 RESTART WITH 51 INCREMENT BY 50;       
CREATE SEQUENCE "PUBLIC"."REFERREDTO2_SEQ" START WITH 1 RESTART WITH 51 INCREMENT BY 50;       
CREATE SEQUENCE "PUBLIC"."REFERREDTO3_SEQ" START WITH 1 RESTART WITH 51 INCREMENT BY 50;       
CREATE MEMORY TABLE "RDBTEST"."CHILD"(
    "ID" BIGINT NOT NULL,
    "RVAL" BIGINT NOT NULL
); 
ALTER TABLE "RDBTEST"."CHILD" ADD CONSTRAINT "RDBTEST"."CONSTRAINT_3" PRIMARY KEY("ID");       
-- 1 +/- SELECT COUNT(*) FROM RDBTEST.CHILD;   
INSERT INTO "RDBTEST"."CHILD" VALUES
(1, 1);   
CREATE MEMORY TABLE "RDBTEST"."LCHILD"(
    "IVAL" INTEGER NOT NULL,
    "LVAL_ORDER" INTEGER,
    "ID" BIGINT NOT NULL,
    "ALTERED_JOIN" BIGINT,
    "SVAL" CHARACTER VARYING(255) NOT NULL
);              
ALTER TABLE "RDBTEST"."LCHILD" ADD CONSTRAINT "RDBTEST"."CONSTRAINT_8" PRIMARY KEY("ID");      
-- 3 +/- SELECT COUNT(*) FROM RDBTEST.LCHILD;  
INSERT INTO "RDBTEST"."LCHILD" VALUES
(1, 0, 1, 1, 'First'),
(2, 1, 2, 1, 'Second'),
(3, 2, 3, 1, 'Third');    
CREATE MEMORY TABLE "RDBTEST"."PARENT"(
    "DVAL_DVALR" FLOAT(53) NOT NULL,
    "TVAL_P_X" FLOAT(53) NOT NULL,
    "TVAL_P_Y" FLOAT(53) NOT NULL,
    "ID" BIGINT NOT NULL,
    "CVAL_ID" BIGINT,
    "DVAL_DREF" BIGINT,
    "RVAL" BIGINT NOT NULL,
    "PARENT_SUBTYPE" CHARACTER VARYING(64) NOT NULL,
    "DVAL_BASESTR" CHARACTER VARYING(255) NOT NULL,
    "DVAL_DVALS" CHARACTER VARYING(255) NOT NULL,
    "DVAL_INTATT" CHARACTER VARYING(255) NOT NULL,
    "TVAL_DT" CHARACTER VARYING(255) NOT NULL
);          
ALTER TABLE "RDBTEST"."PARENT" ADD CONSTRAINT "RDBTEST"."CONSTRAINT_8C3" PRIMARY KEY("ID");    
-- 1 +/- SELECT COUNT(*) FROM RDBTEST.PARENT;  
INSERT INTO "RDBTEST"."PARENT" VALUES
(1.1, 1.5, 3.0, 1, 1, 1, 1, 'jpatest:Parent', 'base', 'astring', 'intatt', 'thing');     
CREATE MEMORY TABLE "RDBTEST"."REFERREDTO1"(
    "ID" BIGINT NOT NULL,
    "SVAL" CHARACTER VARYING(255) NOT NULL
);           
ALTER TABLE "RDBTEST"."REFERREDTO1" ADD CONSTRAINT "RDBTEST"."CONSTRAINT_9" PRIMARY KEY("ID"); 
-- 1 +/- SELECT COUNT(*) FROM RDBTEST.REFERREDTO1;             
INSERT INTO "RDBTEST"."REFERREDTO1" VALUES
(1, 'top level ref');               
CREATE MEMORY TABLE "RDBTEST"."REFERREDTO2"(
    "ID" BIGINT NOT NULL,
    "SVAL" CHARACTER VARYING(255) NOT NULL
);           
ALTER TABLE "RDBTEST"."REFERREDTO2" ADD CONSTRAINT "RDBTEST"."CONSTRAINT_95" PRIMARY KEY("ID");
-- 1 +/- SELECT COUNT(*) FROM RDBTEST.REFERREDTO2;             
INSERT INTO "RDBTEST"."REFERREDTO2" VALUES
(1, 'lower ref');   
CREATE MEMORY TABLE "RDBTEST"."REFERREDTO3"(
    "ID" BIGINT NOT NULL,
    "SVAL" CHARACTER VARYING(255) NOT NULL
);           
ALTER TABLE "RDBTEST"."REFERREDTO3" ADD CONSTRAINT "RDBTEST"."CONSTRAINT_950" PRIMARY KEY("ID");               
-- 1 +/- SELECT COUNT(*) FROM RDBTEST.REFERREDTO3;             
INSERT INTO "RDBTEST"."REFERREDTO3" VALUES
(1, 'ref in dtype');
CREATE MEMORY TABLE "RDBTEST"."SUB"(
    "ID" BIGINT NOT NULL,
    "SUBVAL" CHARACTER VARYING(255) NOT NULL
); 
ALTER TABLE "RDBTEST"."SUB" ADD CONSTRAINT "RDBTEST"."CONSTRAINT_1" PRIMARY KEY("ID");         
-- 0 +/- SELECT COUNT(*) FROM RDBTEST.SUB;     
ALTER TABLE "RDBTEST"."PARENT" ADD CONSTRAINT "RDBTEST"."CONSTRAINT_8C" UNIQUE NULLS DISTINCT ("CVAL_ID");     
ALTER TABLE "RDBTEST"."PARENT" ADD CONSTRAINT "RDBTEST"."FKNCUNHDM0Y83FC6NS45KDFRD1A" FOREIGN KEY("DVAL_DREF") REFERENCES "RDBTEST"."REFERREDTO3"("ID") NOCHECK;               
ALTER TABLE "RDBTEST"."PARENT" ADD CONSTRAINT "RDBTEST"."FKNH8FPTUAT5JGXX0E37TEJTMY0" FOREIGN KEY("CVAL_ID") REFERENCES "RDBTEST"."CHILD"("ID") NOCHECK;       
ALTER TABLE "RDBTEST"."CHILD" ADD CONSTRAINT "RDBTEST"."FK97IM9KMTCOM68DD6LEC0UJIPD" FOREIGN KEY("RVAL") REFERENCES "RDBTEST"."REFERREDTO2"("ID") NOCHECK;     
ALTER TABLE "RDBTEST"."PARENT" ADD CONSTRAINT "RDBTEST"."FK948TL874AVKOBX0AR7IY6P03W" FOREIGN KEY("RVAL") REFERENCES "RDBTEST"."REFERREDTO1"("ID") NOCHECK;    
ALTER TABLE "RDBTEST"."SUB" ADD CONSTRAINT "RDBTEST"."FK8LMOTURSEQC8KSFTLY3BY0AAW" FOREIGN KEY("ID") REFERENCES "RDBTEST"."PARENT"("ID") NOCHECK;              
ALTER TABLE "RDBTEST"."LCHILD" ADD CONSTRAINT "RDBTEST"."FKO9HE2U8E71HKXKECBXM6RHINY" FOREIGN KEY("ALTERED_JOIN") REFERENCES "RDBTEST"."PARENT"("ID") NOCHECK; 
